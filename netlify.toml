# ===============================================================
# Netlify Configuration File
# ===============================================================

# --- Секция Сборки (Build Settings) ---
# Эта секция описывает, как Netlify должен собирать ваш сайт.
[build]
  # Команда, которая будет выполнена для сборки сайта.
  # 1. 'pip install -r requirements.txt': Устанавливает Python-библиотеки (Firebase, Jinja2).
  # 2. '&& python generate_site.py': Запускает ваш скрипт для генерации статических HTML-файлов.
  command = "pip install -r requirements.txt && python generate_site.py"
  
  # Папка, которую нужно опубликовать после успешной сборки.
  # Ваш скрипт-генератор складывает готовый сайт именно сюда.
  publish = "public"

# --- Секция Переадресации и Перезаписи (Redirects & Rewrites) ---
# Эта секция управляет тем, как сервер обрабатывает запросы.
[[redirects]]
  # Для любого запроса, который идет на страницу /product.html...
  from = "/product.html"

  # ...и содержит параметр 'slug' в URL (например, ?slug=my-product)
  query = {slug = ":slug"} # Мы "захватываем" значение slug в переменную :slug

  # ...сервер должен "под капотом" отдать контент из другого файла.
  # Он возьмет захваченное значение :slug и найдет соответствующий
  # сгенерированный HTML-файл.
  to = "/product/:slug/index.html"
  
  # Статус 200 означает "OK". Это говорит Netlify, что нужно выполнить
  # внутреннюю перезапись (rewrite), а не видимую для пользователя
  # переадресацию (redirect). URL в браузере не изменится.
  status = 200
